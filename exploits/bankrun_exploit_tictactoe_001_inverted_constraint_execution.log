===========================================================
 EXPLOIT: Inverted Constraint Deadlock on anchor-tictactoe
 Target: tictactoe::player_join()
 Binary: tictactoe.so (compiled from real open-source program)
===========================================================

[2026-02-13T19:20:00.377581733Z INFO  solana_program_test] "tictactoe" SBF program from /home/user/anchor-shield-v2/exploits/tictactoe.so, modified 6 minutes, 26 seconds, 135 ms, 999 µs and 461 ns ago
[1] Genesis state loaded:
    Dashboard: 4xcfeYvuhXtd7gJZf5axAmz3r8uKV2BtoBeuLyrNx2sF
    Game: GBwQCZYpG2MjkKhQHK5ywp2v27PX2USHF4KDDtu1XqdL
    Player X: 6Xim5j496Lgh...
    Player O: 7mNQfMCzFPgs...
    Game state: 0 (Waiting — default after initialize)

[2] EXPLOIT: Player O attempts to join the game...
    Constraint: game.game_state != 0 && game.player_x != Pubkey::default()
    Current state: game_state = 0 → constraint FAILS

[2026-02-13T19:20:01.101876520Z DEBUG solana_runtime::message_processor::stable_log] Program 8KubqpxK3f59KDmQez1AcfR7ovpMG46UJAZDstQzLQ6c invoke [1]
[2026-02-13T19:20:01.102729407Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: PlayerJoin
[2026-02-13T19:20:01.102817048Z DEBUG solana_runtime::message_processor::stable_log] Program log: AnchorError caused by account: game. Error Code: ConstraintRaw. Error Number: 2003. Error Message: A raw constraint was violated.
[2026-02-13T19:20:01.102850247Z DEBUG solana_runtime::message_processor::stable_log] Program 8KubqpxK3f59KDmQez1AcfR7ovpMG46UJAZDstQzLQ6c consumed 2339 of 200000 compute units
[2026-02-13T19:20:01.102878580Z DEBUG solana_runtime::message_processor::stable_log] Program 8KubqpxK3f59KDmQez1AcfR7ovpMG46UJAZDstQzLQ6c failed: custom program error: 0x7d3
[3] Result: player_join FAILED
    Error: Error: Failed to process transaction: transport transaction error: Error processing Instruction 0: custom program error: 0x7d3

    The Anchor constraint `game.game_state != 0` rejected the transaction.
    This is the INVERTED CONSTRAINT bug:

    1. initialize() creates game with state = 0 (Waiting)
    2. player_join requires state != 0 (i.e., must NOT be Waiting)
    3. No instruction transitions state from 0 before player_join
    4. Player O can NEVER join → game is permanently deadlocked

>>> EXPLOIT CONFIRMED: inverted constraint creates permanent game deadlock <<<

[4] Proof: No escape from deadlock
    player_move requires game_state == 1 (XMove) or 2 (OMove)
    player_join requires game_state != 0 — but state IS 0
    No instruction sets game_state without player_join first
    → DEADLOCK: game stuck in state 0 forever

    IMPACT: Every game created is permanently unplayable.
    No player can ever join, no moves can be made.
    The tictactoe program is completely non-functional.

===========================================================
EXIT CODE: 
EXIT CODE: 0
