===========================================================
 EXPLOIT: Empty Owners List Locks Funds on anchor-multisig
 Target: multisig::create_multisig() + create_transaction()
 Binary: multisig.so (compiled from real open-source program)
===========================================================

[2026-02-13T19:19:05.981822686Z INFO  solana_program_test] "multisig" SBF program from /home/user/anchor-shield-v2/exploits/multisig.so, modified 5 minutes, 31 seconds, 744 ms, 273 µs and 984 ns ago
[1] Genesis state loaded:
    Multisig: FdRnXyu7PjQX8y7BiTXdtQ7kbmd2L4yEMnJNSXjJGvxu
    Owners: [] (EMPTY — the vulnerability)
    Threshold: 0
    PDA signer: CkHMxxZ6YWMqJF6CNSrZowA7NQK3wk37NS9L7R9SX53j (holds 50 SOL)
    Would-be proposer: Duk5rYntWc4GB6fQ...

[2] EXPLOIT: Attempting to create a transaction...
    (create_transaction requires proposer to be in owners list)
    (with empty owners, .position() always returns None → InvalidOwner)

[2026-02-13T19:19:06.699292950Z DEBUG solana_runtime::message_processor::stable_log] Program 9ymvHophSQEXJaEKb85aVa5XHndw5RHcBxGzexTDpQdy invoke [1]
[2026-02-13T19:19:06.699989768Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: CreateTransaction
[2026-02-13T19:19:06.700156591Z DEBUG solana_runtime::message_processor::stable_log] Program log: AnchorError caused by account: transaction. Error Code: ConstraintRentExempt. Error Number: 2005. Error Message: A rent exemption constraint was violated.
[2026-02-13T19:19:06.700212755Z DEBUG solana_runtime::message_processor::stable_log] Program 9ymvHophSQEXJaEKb85aVa5XHndw5RHcBxGzexTDpQdy consumed 3413 of 200000 compute units
[2026-02-13T19:19:06.700231698Z DEBUG solana_runtime::message_processor::stable_log] Program 9ymvHophSQEXJaEKb85aVa5XHndw5RHcBxGzexTDpQdy failed: custom program error: 0x7d5
[3] Transaction creation result:
    REJECTED: Program returned error (InvalidOwner expected)
    Error: Error: Failed to process transaction: transport transaction error: Error processing Instruction 0: custom program error: 0x7d5

    This confirms: with an empty owners list, NO ONE can create
    a transaction. The 50 SOL held by the multisig PDA are
    PERMANENTLY LOCKED — there is no recovery mechanism.

>>> EXPLOIT CONFIRMED: empty owners list permanently locks funds <<<

IMPACT: Any SOL or tokens sent to a multisig PDA with empty owners
        are irrecoverably lost. No transaction can ever be created,
        approved, or executed. The multisig is permanently inoperable.

[4] Verification: checking PDA balance...
    PDA balance: 50 SOL (unchanged — permanently locked)

===========================================================
EXIT CODE: 
EXIT CODE: 0
