═══════════════════════════════════════════════════════════
 EXPLOIT: Integer Overflow + Division by Zero (SEM-003/004)
 Target: vulnerable_lending::liquidate()
 Binary: vuln_lending.so (compiled SBF)
═══════════════════════════════════════════════════════════

--- TEST A: Integer Overflow ---

[2026-02-13T19:19:44.760930901Z INFO  solana_program_test] "vuln_lending" SBF program from /home/user/anchor-shield-v2/exploits/vuln_lending.so, modified 6 minutes, 10 seconds, 517 ms, 376 µs and 19 ns ago
[1] Overflow scenario:
    borrowed: 1000000000 lamports
    interest_rate: 500, total_borrows: 36893488147
    Honest interest: 18446744073500000000000 (overflows u64)
    u64 wrapped:     18446743864157935616

[2] Calling liquidate (user IS underwater, but overflow hides it)...
[2026-02-13T19:19:45.493401448Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:45.494250788Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Liquidate
[2026-02-13T19:19:45.494332210Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 1491 of 200000 compute units
[2026-02-13T19:19:45.494364846Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Liquidation succeeded (user correctly found underwater)

--- TEST B: Division by Zero ---

[2026-02-13T19:19:45.499167623Z INFO  solana_program_test] "vuln_lending" SBF program from /home/user/anchor-shield-v2/exploits/vuln_lending.so, modified 6 minutes, 11 seconds, 255 ms, 634 µs and 704 ns ago
[3] Calling liquidate with zero-borrow user...
    health = deposited * 100 / (borrowed + interest)
    health = 10_000_000_000 * 100 / (0 + 0) => DIVISION BY ZERO

[2026-02-13T19:19:46.269823587Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:46.270743738Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Liquidate
[2026-02-13T19:19:46.270852403Z DEBUG solana_runtime::message_processor::stable_log] Program log: panicked at programs/vulnerable-lending/src/lib.rs:104:22:
    attempt to divide by zero
[2026-02-13T19:19:46.270886657Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 2964 of 200000 compute units
[2026-02-13T19:19:46.270924369Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K failed: SBF program panicked
    Program CRASHED: Failed to process transaction: transport transaction error: Error processing Instruction 0: Program failed to complete
    (confirms division by zero causes program panic)

═══════════════════════════════════════════════════════════
 EXPLOIT RESULTS (compiled SBF binary):
   Integer overflow (SEM-003): Result: liquidation_succeeded
   Division by zero (SEM-004): CONFIRMED --- program panics on zero borrows
═══════════════════════════════════════════════════════════
EXIT CODE: 
EXIT CODE: 0
