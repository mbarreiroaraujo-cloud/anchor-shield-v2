===========================================================
 EXPLOIT: Incomplete Unstake on solana-staking
 Target: skinflip_staking::unstake()
 Binary: skinflip_staking.so (compiled from real program)
===========================================================

[2026-02-13T19:20:24.515738277Z INFO  solana_program_test] "skinflip_staking" SBF program from /home/user/anchor-shield-v2/exploits/skinflip_staking.so, modified 6 minutes, 50 seconds, 275 ms, 185 µs and 735 ns ago
[1] Genesis state (simulates a staked NFT):
    Staking machine: HnzSmM4egv8r...
    Staked NFTs: 1
    NFT holder: BpoY7m7cNcY6...
    NFT stake data: 2PeTwFRZLd4o... (PDA)
    Staked at: 1771006824 (1 hour ago)

[2] Pre-unstake staked_nfts: 1

[3] Calling unstake()...
    (In correct implementation, NFT would be transferred back)

[2026-02-13T19:20:25.250785430Z DEBUG solana_runtime::message_processor::stable_log] Program 8PwEDGC8wVDy1GpMJ3wzngKnViFpHvWEABsuMBVjX5at invoke [1]
[2026-02-13T19:20:25.251679044Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Unstake
[2026-02-13T19:20:25.251755184Z DEBUG solana_runtime::message_processor::stable_log] Program log: Unstake SkinFlip NFT
[2026-02-13T19:20:25.251842746Z DEBUG solana_runtime::message_processor::stable_log] Program log: NFT: B8rATfjYBXr6mbpuHejy43mqd21ptTbS2XDao2cy4HEw
[2026-02-13T19:20:25.251901015Z DEBUG solana_runtime::message_processor::stable_log] Program log: NFT holder: BpoY7m7cNcY65YULSWnEwasV9M8vMe1AGhmJm62hkDFM
[2026-02-13T19:20:25.251917679Z DEBUG solana_runtime::message_processor::stable_log] Program log: Staked nfts 1
[2026-02-13T19:20:25.251928981Z DEBUG solana_runtime::message_processor::stable_log] Program log: Staked at 1771006824, time diff: 3600
[2026-02-13T19:20:25.252119151Z DEBUG solana_runtime::message_processor::stable_log] Program 8PwEDGC8wVDy1GpMJ3wzngKnViFpHvWEABsuMBVjX5at consumed 28077 of 200000 compute units
[2026-02-13T19:20:25.252146488Z DEBUG solana_runtime::message_processor::stable_log] Program 8PwEDGC8wVDy1GpMJ3wzngKnViFpHvWEABsuMBVjX5at success
[4] unstake() returned Ok(()) — appears to succeed

[5] Post-unstake state:
    staked_nfts before: 1
    staked_nfts after:  1
    Counter changed:    NO — counter not decremented

>>> EXPLOIT CONFIRMED: unstake() is incomplete <<<

    The unstake function:
    1. Returns Ok(()) (appears successful)
    2. Logs time_diff (cosmetic only)
    3. Does NOT transfer NFT back from vault
    4. Does NOT decrement staked_nfts counter

    IMPACT: NFTs are permanently locked in the vault.
    Users believe they unstaked but their NFTs are gone.
    This is an irreversible loss of user assets.

===========================================================
EXIT CODE: 
EXIT CODE: 0
